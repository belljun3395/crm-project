#!/bin/sh

set -e

echo "ğŸš€ Stop Kubernetes k6 deployment..."

K6_DIR="../k8s/k6"
ORIGINAL_DIR=$(pwd)
echo "ğŸ“Executing the script in the directory: $ORIGINAL_DIR"

if [ ! -d "$K6_DIR" ]; then
  echo "âŒ Error: Directory $K6_DIR does not exist!"
  exit 1
fi

echo "ğŸ“‚ Changing directory to k6 manifests..."

cd "$K6_DIR"

echo "ğŸ—‘ï¸ Deleting existing k6 resources..."
kubectl delete -f . || echo "âš ï¸  Warning: Some k6 resources might not exist."

echo "âœ… K6 resources updated successfully."

echo "ğŸ”™ Returning to the original script directory: $ORIGINAL_DIR"
cd "$ORIGINAL_DIR"

echo "ğŸ‰ Kubernetes k6 deployment completed!"