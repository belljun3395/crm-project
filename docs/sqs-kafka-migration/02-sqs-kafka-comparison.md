# SQS ↔ Kafka 비교

## 요약
- SQS는 간편한 매니지드 서비스를 제공하지만, Kafka는 운영 책임이 커지는 대신 리플레이·스트리밍 기능이 훨씬 풍부합니다.
- 전달 보장, 순서 제어, 확장 모델이 크게 다르므로 마이그레이션 전에 애플리케이션 로직을 조정해야 회귀를 막을 수 있습니다.

## 기능 비교표

| 항목                       | AWS SQS (Standard)                                  | Apache Kafka                                              | 마이그레이션 시사점                                         |
|---------------------------|------------------------------------------------------|-----------------------------------------------------------|--------------------------------------------------------------|
| 전달 보장                 | 최소 1회, Visibility Timeout 기반                   | 기본은 최소 1회, 멱등 프로듀서+트랜잭셔널 컨슈머로 정확히 1회까지 가능 | 컨슈머가 커밋·멱등 키를 직접 관리해야 함.                  |
| 순서 보장                 | 베스트 에포트 (전용 FIFO 큐 필요)                   | 파티션별 순서 보장, 키로 제어 가능                        | 비즈니스 순서 요구에 맞는 파티션 키 설계 필수.             |
| 처리량 확장               | 자동 확장, 큐가 프로듀서/컨슈머 분리                | 파티션 수와 브로커 용량에 의존                            | 파티션 사이징과 컨슈머 그룹 확장 전략 필요.               |
| 메시지 보존               | ACK 시 삭제                                         | 시간/용량 기반 보존, 로그 컴팩션 옵션                     | 리플레이·백필 가능하지만 스토리지 모니터링 필요.           |
| 데드레터 처리             | 큐별 DLQ                                            | DLQ 토픽 또는 별도 저장소                                 | DLQ 메타데이터 스키마를 표준화해 재처리 용이성 확보.       |
| 비용 모델                 | 요청당 과금                                         | 브로커 인스턴스 + 스토리지 + 네트워킹 비용               | 듀얼 라이트 기간을 분석해 중복 비용을 통제.               |
| 관측성                    | CloudWatch 지표/로그                                | Prometheus/JMX 지표, 외부 툴(Grafana, Kafka UI 등)       | 프로덕션 전환 전에 모니터링 스택을 선 구축.                |
| 보안 및 접근              | IAM 정책                                            | SASL/SCRAM, TLS, ACL                                      | IAM 역할을 Kafka 주체로 매핑, 암호화 강제.                 |
| 재시도 전략               | Visibility Timeout + Redrive                        | 컨슈머 주도 재시도, DLQ 토픽                              | 컨슈머 그룹 내부에 지수 백오프 로직 구현.                  |
| 스키마 관리               | 기본 제공 없음                                      | Schema Registry (Avro/JSON Schema/Protobuf)               | 레지스트리를 도입해 파괴적 변경 예방.                     |

## 핵심 포인트
- Kafka의 확장된 기능을 쓰려면 컨슈머가 오프셋 커밋, 배치 처리, 파티션 리밸런스를 명시적으로 제어해야 합니다.
- 관측성과 용량 계획이 “AWS가 대신 관리”에서 “셀프 매니지드”로 바뀌므로 자동화와 알림 체계가 필수입니다.
- 비즈니스 로직을 보호하려면 차이를 흡수할 추상화 계층을 구축하는 것이 마이그레이션 성공의 핵심입니다.
