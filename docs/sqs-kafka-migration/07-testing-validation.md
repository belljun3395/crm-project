# 테스트 및 검증

## 자동화 테스트
- 메시징 어댑터를 목 기반 단위 테스트로 검증해 직렬화·에러 처리가 일관되게 동작하는지 확인합니다.
- Testcontainers 기반 Kafka를 활용한 통합 테스트로 듀얼 라이트 로직과 실패 시 복구 동작을 점검합니다.
- 프로듀서와 컨슈머 간 스키마 호환성을 보장하기 위해 계약 테스트를 추가합니다.

## 성능·부하 검증
- 피크 처리량을 가정한 부하 테스트를 수행해 프로듀서 배치, 컨슈머 lag, 브로커 자원 사용량을 측정합니다.
- SQS 경로와 Kafka 경로의 지연을 벤치마크하여 배치 및 ACK 설정을 튜닝합니다.
- DLQ 처리 파이프라인을 스트레스 테스트해 리플레이 도구의 확장성을 검증합니다.

## 관측성 검증
- Micrometer/Prometheus 지표가 수동 트래픽 주입 결과와 일치하는지 확인합니다.
- Lag 임계치, 브로커 다운타임, 스키마 오류 등 주요 경보가 적시에 발생하는지 점검합니다.
- 프로듀서·컨슈머 서비스 전체에서 트레이스 ID를 활용한 로그 상관관계를 검증합니다.

## 롤아웃 안전장치
- 트래픽 일부만 Kafka 컨슈머로 보내는 카나리아 배포를 적용합니다.
- 메시지 흐름 성공률, lag, DLQ 적재량을 포함한 자동화 헬스체크를 구성하고 통과 후에만 롤아웃을 확대합니다.
- 비프로덕션 환경에서 롤백 절차를 반복 검증해 실제 상황에서도 즉시 수행될 수 있도록 준비합니다.
